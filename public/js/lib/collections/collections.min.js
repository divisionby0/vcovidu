var ListIterator=function(){function t(t){this.counter=-1,this.collection=t}return t.prototype.hasNext=function(){return this.counter+1<this.collection.size()},t.prototype.next=function(){return this.counter+=1,this.collection.get(this.counter)},t}(),MapIterator=function(){function t(t){this.counter=-1,this.collection=t,this.keys=this.collection.getKeys()}return t.prototype.hasNext=function(){return this.counter+1<this.keys.length},t.prototype.next=function(){this.counter+=1;var t=this.keys[this.counter];return this.collection.get(t)},t.prototype.size=function(){return this.keys.length},t}(),List=function(){function t(t){t&&(this.id=t),this.items=[]}return t.prototype.size=function(){return this.items.length},t.prototype.add=function(t){this.items.push(t)},t.prototype.get=function(t){return this.items[t]},t.prototype.remove=function(t){this.items.splice(t,1)},t.prototype.clear=function(){this.items=[]},t.prototype.getIterator=function(){return new ListIterator(this)},t.prototype.setId=function(t){this.id=t},t.prototype.getId=function(){return this.id},t}(),Map=function(){function t(t){this.keys=new Array,t&&(this.id=t),this.items={}}return t.prototype.removeKey=function(t){var e=this.keys.indexOf(t);this.keys.splice(e,1)},t.prototype.add=function(t,e){if(this.has(t))throw new Error(t+" already exists");this.items[t]=e,this.keys.push(t)},t.prototype.remove=function(t){delete this.items[t],this.removeKey(t)},t.prototype.update=function(t,e){var o=this.get(t);void 0!=o&&null!=o?this.items[t]=e:console.error("Map error. No such element by key "+t)},t.prototype.clear=function(){this.keys=new Array,this.items={}},t.prototype.has=function(t){return t in this.items},t.prototype.get=function(t){return this.items[t]},t.prototype.getKeys=function(){return this.keys},t.prototype.size=function(){return this.keys.length},t.prototype.getIterator=function(){return new MapIterator(this)},t.prototype.setId=function(t){this.id=t},t.prototype.getId=function(){return this.id},t.prototype.getEncoder=function(){return new MapJsonEncoder(this)},t}(),MapJsonDecoder=function(){function t(t){this.rootMap=new Map("rootMap"),this.dataString=t}return t.prototype.decode=function(){return this.parseStringToMap(this.dataString,this.rootMap),this.rootMap},t.prototype.parseStringToMap=function(t,e){var o="";try{o=JSON.parse(t)}catch(t){throw new Error("Not valid json.")}this.parseObjectToMap(o,e)},t.prototype.parseObjectToMap=function(t,e){t.id;if("Map"==t.type)for(var o in t){var r=t[o],n=r.id,i=r.type;if("id"!=o&&"type"!=o&&"Map"==i){var s=new Map(n);e.add(o,this.parseObjectToMap(r,s))}else"id"===o?e.setId(r):"type"!=o&&e.add(o,r)}return e},t}(),MapJsonEncoder=function(){function t(t){this.collection=t}return t.prototype.encode=function(){var t=this.parseToObject(this.collection);return JSON.stringify(t)},t.prototype.parseToObject=function(t){var e={};e.id=t.getId(),e.type="Map";var o=t.getKeys();for(var r in o){var n=o[r],i=t.get(n),s=i instanceof Map;e[n]=s?this.parseToObject(i):i}return e},t}();